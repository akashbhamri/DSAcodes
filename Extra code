Initial Investigation

Upon receiving a Splunk alert indicating a SQL exception and the inability to connect to the database server, the team initiated the investigation. The alert subject provided details about the affected server, which was a Windows DB server.

New Relic Investigation

The server utilization was reviewed in New Relic, and no signs of high resource utilization were observed. The metrics for CPU, memory, and disk usage appeared normal, ruling out resource saturation as the cause of the alert.

Splunk Log Analysis

Using the grep command, we searched for relevant processes related to Bitbucket in the logs. The analysis confirmed that the process was running without any interruptions. However, the Splunk logs indicated the SQL exception was persisting, corroborating the alert details.

Incident Raised with the DB Team

An incident was raised with the database team, including:

The alert subject details.

The Windows DB server details.

Observations from Splunk and New Relic investigations.

The issue was escalated, and collaborative troubleshooting began with the database team in a team chat.

Database Team Findings

After their analysis, the database team reported:

The server was functioning normally, with no connectivity issues or unusual activity.

The issue was likely caused by a long-running query in the database logs.

Once the query completed, the SQL exception and connection issues were resolved automatically.

Root Cause Analysis (RCA)

The root cause was determined to be a long-running query that temporarily impacted the databaseâ€™s ability to establish new connections. This created transient SQL exceptions, triggering the Splunk alert. After the query execution completed, the system resumed normal operations.

Conclusion

The incident was resolved without any server-side issues, and the database server returned to normal functionality. Moving forward, we recommend the following:

Query Optimization: Review and optimize long-running queries to prevent similar issues.

Proactive Monitoring: Set alerts for query execution times exceeding a threshold.

Collaboration Workflow: Maintain close communication with the database team for quicker resolutions.
